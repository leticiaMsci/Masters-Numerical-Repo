(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     19911,        552]
NotebookOptionsPosition[     18777,        526]
NotebookOutlinePosition[     19209,        542]
CellTagsIndexPosition[     19166,        539]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Optical Fields", "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8135763361868057`*^9, 3.813576339015432*^9}, 
   3.8135799690313683`*^9},ExpressionUUID->"29f20ebe-82a1-4916-8ff9-\
d277186144b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]hat", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"\[Phi]hat", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", " ", 
  RowBox[{"rhat", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalPi]", 
     RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", "\[Theta]_", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", "epsilonmaterial", "]"}], "/", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}], 
    RowBox[{"LegendreP", "[", 
     RowBox[{"\[ScriptL]", ",", "m", ",", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalTau]", 
      RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", "\[Theta]_", "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"LegendreP", "[", 
       RowBox[{"\[ScriptL]", ",", "m", ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], ",", " ", 
      "\[Theta]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", "\[Theta]_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}], 
     "\[Theta]hat"}], "-", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalTau]", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}], 
     "\[Phi]hat"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Y", 
     RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", "\[Theta]_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalTau]", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}], 
     "\[Theta]hat"}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}], 
     "\[Phi]hat"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Z", 
      RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", "\[Theta]_", "]"}], "=", 
    RowBox[{"\[ScriptL]", 
     RowBox[{"(", 
      RowBox[{"\[ScriptL]", "+", "1"}], ")"}], 
     RowBox[{"LegendreP", "[", 
      RowBox[{"\[ScriptL]", ",", "m", ",", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "  ", "rhat"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   "0"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], "/", 
      RowBox[{"(", 
       RowBox[{"k", " ", "r"}], ")"}]}], ")"}], 
    RowBox[{
     SubscriptBox["S", "\[ScriptL]"], "[", "r", "]"}], " ", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}]}], "*)"}], 
  " ", ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", "\[NotEqual]", 
     RowBox[{"0", " ", "for", " ", "TE", " ", "modes"}]}], ",", " ", 
    RowBox[{"N", "\[NotEqual]", 
     RowBox[{"0", " ", "for", " ", "TM", " ", "modes"}]}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["N", 
      RowBox[{"\[ScriptL]_", ",", "m_"}]], "[", 
     RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "epsilonmaterial"}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "r"}], ")"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["T", "\[ScriptL]"], "[", "r", "]"}], ",", " ", "r"}], 
         "]"}], 
        RowBox[{
         SubscriptBox["Y", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          SuperscriptBox["r", "2"]}], ")"}], 
        RowBox[{
         SubscriptBox["T", "\[ScriptL]"], "[", "r", "]"}], 
        RowBox[{
         SubscriptBox["Z", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", "\[Theta]", "]"}]}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["e", "r"], "[", 
   RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
      RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["N", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
      RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ")"}],
    "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["e", "\[Theta]"], "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
      RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["N", 
       RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
      RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ")"}],
    "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "\[Phi]"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["M", 
        RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
       RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
      RowBox[{
       SubscriptBox["N", 
        RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
       RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
     ")"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["epump", "r"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         SubscriptBox["N", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptL]", "->", "\[ScriptL]pump"}], ",", " ", 
      RowBox[{"m", "\[Rule]", "mpump"}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", "\[Omega]pump"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["epump", "\[Theta]"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         SubscriptBox["N", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptL]", "->", "\[ScriptL]pump"}], ",", " ", 
      RowBox[{"m", "\[Rule]", "mpump"}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", "\[Omega]pump"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["epump", "\[Phi]"], "[", 
     RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["M", 
           RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
          RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
         RowBox[{
          SubscriptBox["N", 
           RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
          RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
        ")"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "->", "\[ScriptL]pump"}], ",", " ", 
       RowBox[{"m", "\[Rule]", "mpump"}], ",", " ", 
       RowBox[{"\[Omega]", "\[Rule]", "\[Omega]pump"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["eStokes", "r"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         SubscriptBox["N", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptL]", "->", "\[ScriptL]Stokes"}], ",", " ", 
      RowBox[{"m", "\[Rule]", 
       RowBox[{"-", "mStokes"}]}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", "\[Omega]Stokes"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["eStokes", "\[Theta]"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         SubscriptBox["N", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptL]", "->", "\[ScriptL]Stokes"}], ",", " ", 
      RowBox[{"m", "\[Rule]", 
       RowBox[{"-", "mStokes"}]}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", "\[Omega]Stokes"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["eStokes", "\[Phi]"], "[", 
    RowBox[{"r_", ",", " ", "\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         SubscriptBox["N", 
          RowBox[{"\[ScriptL]", ",", "m"}]], "[", 
         RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptL]", "->", "\[ScriptL]Stokes"}], ",", " ", 
      RowBox[{"m", "\[Rule]", 
       RowBox[{"-", "mStokes"}]}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", "\[Omega]Stokes"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.813576361834938*^9, 3.813576544305017*^9}, {
   3.813576589566869*^9, 3.8135765919370193`*^9}, 3.8135799690313683`*^9, {
   3.814005812612382*^9, 3.8140058306948376`*^9}, {3.8140058785730796`*^9, 
   3.814005882051896*^9}, {3.8140060202643695`*^9, 3.8140060716656647`*^9}, {
   3.8140061785839014`*^9, 3.8140061969845686`*^9}, {3.8140067196530085`*^9, 
   3.8140067231444526`*^9}, {3.814007451684637*^9, 3.814007482167419*^9}, {
   3.820073218207086*^9, 3.8200732198377542`*^9}, {3.820073912942809*^9, 
   3.820073920459772*^9}, {3.820587762524723*^9, 3.820587769954486*^9}, {
   3.820587948708027*^9, 3.8205879548826714`*^9}, {3.822323671299677*^9, 
   3.822323803210988*^9}, {3.8223239963164325`*^9, 3.822324010166879*^9}, {
   3.822324042055998*^9, 3.8223240569090023`*^9}, {3.8224042501027822`*^9, 
   3.822404267652804*^9}, {3.822413335378724*^9, 3.82241334350849*^9}, 
   3.8225799955464964`*^9, {3.82258002619524*^9, 3.8225800426965084`*^9}, {
   3.822654367977811*^9, 3.822654369349382*^9}, 3.8226623739942803`*^9, {
   3.823099485618843*^9, 3.823099486950432*^9}, {3.823099532012929*^9, 
   3.823099574985155*^9}, {3.8263880338079967`*^9, 3.8263880372233887`*^9}, 
   3.8272501630656223`*^9, 
   3.841742870285983*^9},ExpressionUUID->"e39ca863-b661-4932-91e4-\
e834e2134bdb"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", "\[ScriptL]", 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "\[ScriptL]"}], ")"}], " ", 
   RowBox[{"LegendreP", "[", 
    RowBox[{"\[ScriptL]", ",", "m", ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
   RowBox[{
    SubscriptBox["T", "\[ScriptL]"], "[", "r", "]"}]}], 
  RowBox[{
   SuperscriptBox["k", "2"], " ", 
   SuperscriptBox["r", "2"], " ", 
   RowBox[{"\[Epsilon]", "[", "r", "]"}]}]]], "Output",
 CellChangeTimes->{{3.8230995679878826`*^9, 3.823099577715872*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"14242c76-5ed3-4f1d-a2b9-268424a470f1"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "\[ScriptL]"}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{"\[ScriptL]", ",", "m", ",", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "+", "\[ScriptL]"}], ")"}], " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[ScriptL]"}], ",", "m", ",", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["T", "\[ScriptL]"], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "2"], " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"\[Epsilon]", "[", "r", "]"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8230995679878826`*^9, 3.8230995777228537`*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"5553ab87-4f8e-443b-ad28-69922c912376"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", "m", " ", 
    RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"LegendreP", "[", 
     RowBox[{"\[ScriptL]", ",", "m", ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["T", "\[ScriptL]"], "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    SuperscriptBox["k", "2"], " ", "r", " ", 
    RowBox[{"\[Epsilon]", "[", "r", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.8230995679878826`*^9, 3.8230995777298346`*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"83c3e1a4-e50b-4fba-8ef9-c6082d11b54f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", "\"\<Optical TM Fields Successfully Defined!\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.823099314279552*^9, 3.823099367077463*^9}, {
  3.823099413701713*^9, 3.8230994163268967`*^9}, {3.823099462233391*^9, 
  3.823099463755309*^9}, {3.8230995533079967`*^9, 3.8230995548382072`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"0b2f239f-92de-4448-9dc6-5e41c31fae1e"],

Cell[BoxData["\<\"Optical TM Fields Successfully Defined!\"\>"], "Print",
 CellChangeTimes->{3.8230994678308215`*^9, 3.8230995622111483`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"e6c25066-f1e9-4e1b-84be-2eec84a2ea43"]
}, Open  ]]
},
WindowSize->{766.8, 795.5999999999999},
WindowMargins->{{Automatic, -4.7999999999999545`}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c966e74a-9f0a-48fd-a8a8-e8604aab8095"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 242, 4, 53, "Subtitle",ExpressionUUID->"29f20ebe-82a1-4916-8ff9-d277186144b5",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[825, 28, 14214, 396, 646, "Input",ExpressionUUID->"e39ca863-b661-4932-91e4-e834e2134bdb",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[15054, 427, 714, 18, 55, "Output",ExpressionUUID->"14242c76-5ed3-4f1d-a2b9-268424a470f1"],
Cell[15771, 447, 1535, 40, 59, "Output",ExpressionUUID->"5553ab87-4f8e-443b-ad28-69922c912376"],
Cell[17309, 489, 776, 18, 55, "Output",ExpressionUUID->"83c3e1a4-e50b-4fba-8ef9-c6082d11b54f"],
Cell[CellGroupData[{
Cell[18110, 511, 402, 6, 28, "Input",ExpressionUUID->"0b2f239f-92de-4448-9dc6-5e41c31fae1e"],
Cell[18515, 519, 246, 4, 21, "Print",ExpressionUUID->"e6c25066-f1e9-4e1b-84be-2eec84a2ea43"]
}, Open  ]]
}
]
*)

